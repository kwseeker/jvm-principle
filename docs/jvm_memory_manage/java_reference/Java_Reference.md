# Java 四种引用

这部分属于JVM GC知识范畴。



## Java对象生命周期

参考 《垃圾回收GC.md》。

## GC回收对象监控



## 分类&特点

| 引用类型 | 被垃圾回收时机   | 用途               | 生存时间          |
| -------- | ---------------- | ------------------ | ----------------- |
| 强引用   | 从来不会         | 对象的一般状态     | JVM停止运行时终止 |
| 软引用   | 当内存不足前     | 对象缓存           | 内存不足时终止    |
| 弱引用   | GC一看到立刻回收 | 对象缓存           | 垃圾回收后终止    |
| 虚引用   | 随时随刻         | 跟踪对象的垃圾回收 | 垃圾回收后终止    |

根据对引用对象内存回收的限制程度区分：

+ **强引用**[寸土不让]（工作中大部分都是这种）

  除非对象不可达，否则即使报内存耗尽也不能回收。

+ **软引用**[实在困难了可以通融]

  这种引用在实现缓存机制的时候使用的比较多,还可以防止缓存过大造成OOM。

  如果一个对象只有软引用，当内存不足的时候GC可以回收它，但是内存充足的时候不可以回收。
  
+ **弱引用**[老好人]

  WeakHashMap中的键使用了软引用，当程序中引用这个键的强引用被删除后，这个键值对可以在未来很快被JVM回收。

  如果一个对象只有弱引用，GC想回收它可以随时回收。
  在回收流程中扫描到弱引用的话，不管内存是否紧张都会回收它。

+ **虚引用**[形同不存在]

  GC可以在任何时候回收它，虚引用主要用于GC跟踪对象被垃圾回收的活动。主要是跟踪堆外内存的垃圾回收。
  
  

### 使用案例



## GC引用回收原理

TODO：阅读JVM引用相关源码。Java引用的回收控制是JVM内部实现的。



## Cleaner & finalize